# ë©”ì¸ ë§ˆí¬ë‹¤ìš´(README.md)
[â–¶ ë©”ì¸ ë§ˆí¬ë‹¤ìš´.md](README.md)

# Redis Install 
<details>
<summary>í¼ì¹˜ê¸°/ì ‘ê¸°</summary>

ì•„ë§ˆì¡´ AWS EC2 ì„œë²„ë¥¼ ì‚¬ìš©í•˜ëŠ” ê°•ì˜ì™€ëŠ” ë‹¤ë¥´ê²Œ, ë¡œì»¬ì— ì„¤ì¹˜í•œë‹¤.
https://github.com/microsoftarchive/redis/releases  
ìœ„ ë§í¬ì—ì„œ msi í˜¹ì€ zipíŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ í•œë‹¤.  
https://dnl1029.tistory.com/49  
ì„¤ì¹˜ ê³¼ì •ì€ í•´ë‹¹ ë¸”ë¡œê·¸ë¥¼ ì°¸ì¡°í•œë‹¤.
</details>

# Redis ì£¼ìš” ì„¤ì • 1 - Master-Replica(êµ¬Slave) êµ¬ì„±
<details>
<summary>í¼ì¹˜ê¸°/ì ‘ê¸°</summary>

## Redis ì„¤ì¹˜ í›„ ë””ë ‰í† ë¦¬ ì£¼ìš” íŒŒì¼ ê¸°ë³¸ êµ¬ì„±
ğŸ“‚C:   
â”  ğŸ“‚ Program Files  
â”ƒ â”  ğŸ“‚ **Redis**  
â”ƒ â”ƒ â”  ğŸ“ log  
â”ƒ â”ƒ â”  ğŸ“„**redis.windows.conf**  
â”ƒ â”ƒ â”  ğŸ“„**redis.cli.exe**  
â”ƒ â”ƒ â”– ğŸ“„**redis.server.exe**  

### Redis ì„¤ì¹˜ í›„ ìµœì´ˆ ì‹¤í–‰

<details>
<summary>í¼ì¹˜ê¸°/ì ‘ê¸°</summary>

ì„¤ì¹˜ ì™„ë£Œ í›„ redis-cli.exe íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.
```
redis-server.exe redis.windows.conf
```

info ëª…ë ¹ì„ ì…ë ¥í•œë‹¤.
```bash
127.0.0.1:6379> info
```

```text/plain
# Server
/* ìƒëµ */
redis_mode:standalone
/* ìƒëµ */
# Replication
role:master
/* ìƒëµ */
```
ìœ„ì™€ ê°™ì´ standalone ëª¨ë“œì— master roleë¡œ ì„¤ì •ë˜ì–´ìˆë‹¤.
master-replica êµ¬ì„±ì„ ìœ„í•œ replica ì„¤ì •ì„ í•´ì•¼í•œë‹¤.

</details>

### Master-Replica ê¸°ë³¸ ë‹¨ì¼ ì„¤ì • íŒŒì¼ ìˆ˜ì • ë° ì‹¤í–‰
<details>
<summary>í¼ì¹˜ê¸°/ì ‘ê¸°</summary>
ì¸ê°•ì—ì„œëŠ” masterìš© ì¸ìŠ¤í„´ìŠ¤ì™€ repilcaìš© ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë”°ë¡œ êµ¬ì„±í•˜ì˜€ìœ¼ë‚˜, í˜„ì¬ëŠ” ë¡œì»¬ë¡œ ê¸°ë™í•˜ê¸°ì— í¬íŠ¸ë¡œ êµ¬ë¶„í•˜ì—¬ ì ‘ì†í•œë‹¤.  

ì•„ë˜ ë§í¬ë¥¼ ì°¸ì¡°í•œë‹¤.  
[â–¶ ì°¸ì¡° ë¸”ë¡œê·¸](https://ssjeong.tistory.com/entry/Redis-%EB%A0%88%EB%94%94%EC%8A%A4-Windows%EC%97%90%EC%84%9C-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EA%B5%AC%EB%8F%99%ED%95%98%EA%B8%B0standalone-cluster#%23%C2%A0Redis%C2%A0Standalone%20Slave%20%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0-1)  
[â–¶ redis ì„¤ì • ì°¸ì¡° ë§í¬](https://adjin.tistory.com/9)

```bash
redis-server --port 6380 --replicaof 127.0.0.1 6379
```
(5.0ë²„ì „ ë¯¸ë§Œì¸ ê²½ìš° replcaofê°€ ì•„ë‹Œ slaveof ì˜µì…˜ì„ ì‚¬ìš©í•´ì•¼ í•¨.)

ìœ„ ëª…ë ¹ì–´ëŠ” redisë¥¼ ì¦‰ì‹œ ì‹¤í–‰í•˜ì§€ë§Œ, redisë¥¼ ì¬ì‹œì‘ í•  ê²½ìš° ì„¤ì •ì´ ìœ ì§€ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì§€ì†ì ì¸ ì„¤ì •ì„ ì›í•œë‹¤ë©´ ì„¤ì • íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

## Redis Version 5.0 ì´ìƒì¸ê²½ìš°
replicaof ì˜µì…˜ì„ ì‚¬ìš©í•œë‹¤.

- redis.window.config
  ```text/plain
  ################################ GENERAL  #####################################

  # On Windows, daemonize and pidfile are not supported.
  # However, you can run redis as a Windows service, and specify a logfile.
  # The logfile will contain the pid.

  # Accept connections on the specified port, default is 6379.
  # If port 0 is specified Redis will not listen on a TCP socket.
  # port 6379 # ê¸°ì¡´ ê¸°ë³¸ port ì£¼ì„
  port 6380
  replicaof 127.0.0.1 6379  
  ```

## Redis Version 5.0 ë¯¸ë§Œì¸ê²½ìš° (í˜„ì¬ 3.0)
slaveof ì˜µì…˜ì„ ì‚¬ìš©í•œë‹¤.

- redis.window.config
  ```text/plain
  ################################ GENERAL  #####################################

  # On Windows, daemonize and pidfile are not supported.
  # However, you can run redis as a Windows service, and specify a logfile.
  # The logfile will contain the pid.

  # Accept connections on the specified port, default is 6379.
  # If port 0 is specified Redis will not listen on a TCP socket.
  # port 6379 # ê¸°ì¡´ ê¸°ë³¸ port ì£¼ì„
  port 6380
  slaveof 127.0.0.1 6379  
  ```
- slave ì‹¤í–‰
  ```bash
  redis-server.exe redis.windows.conf
  ```

### ì‹¤íŒ¨ 1

```text/plain
[28616] 29 Dec 02:32:57.339 * Non blocking connect for SYNC fired the event.
[28616] 29 Dec 02:32:57.339 # Sending command to master in replication handshake: -Writing to master: Unknown error
[28616] 29 Dec 02:32:57.460 * Connecting to MASTER 127.0.0.1:6379
[28616] 29 Dec 02:32:57.460 * MASTER <-> SLAVE sync started
```
ì‹¤í–‰ í›„ ìœ„ ë¡œê·¸ê°€ ì—°ì´ì–´ ì¶œë ¥ ë˜ëŠ”ë°, ì •ìƒì¼ ê²½ìš°ì—ëŠ” sync startë§Œ ë˜ëŠ”ê²ƒì´ ì•„ë‹Œ ì‹¤ì œ ì‘ì—…ì´ ì¼ì–´ë‚˜ì•¼ í•œë‹¤.  
6379 portê°€ í†µì‹ í•  ìˆ˜ ìˆë„ë¡ ê°œë°©ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— startë§Œ ëœ¨ê³  ì‹¤ì œ ì‘ì—…ì€ ì¼ì–´ë‚˜ì§€ ì•Šê³  ë‹¤ìš´ ìƒíƒœë¡œ ë˜ì–´ìˆëŠ”ê²ƒì´ë‹¤.  
ì•„ë§ˆì¡´ awsì—ì„œ ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ë¡œ êµ¬ì„±í–ˆì„ ê²½ìš°ì—ëŠ” ì¶”ê°€ ë³´ì•ˆì„¤ì •ì„ í•´ì¤˜ì•¼ í•œë‹¤.

ë¡œì»¬ì—ì„œ ê¸°ë™í•  ê²½ìš°, ê¸°ë³¸ì ìœ¼ë¡œ redis-server.exe íŒŒì¼ì„ ë¨¼ì € ì‹¤í–‰í•œ ë’¤[6379-master] 
redis-server.exe redis.windows.confë¥¼ ì‹¤í–‰í•´ì¤˜ì•¼í•œë‹¤[6380-slave(replica)]

- master-6379 ì‹¤í–‰
  ```bash
  .\redis-cli.exe
  ```

- slave-6380 ì‹¤í–‰
  ```bash
  .\redis-cli.exe -p 6380
  ```


### ì‹¤íŒ¨ 2

- master-6379
  ```text
  [22532] 29 Dec 03:10:16.712 # Server started, Redis version 3.0.504
  [22532] 29 Dec 03:10:16.721 * DB loaded from disk: 0.010 seconds
  [22532] 29 Dec 03:10:16.721 * The server is now ready to accept connections on port 6379
  [22532] 29 Dec 03:10:24.186 * Slave 127.0.0.1:6380 asks for synchronization
  [22532] 29 Dec 03:10:24.186 * Full resync requested by slave 127.0.0.1:6380
  [22532] 29 Dec 03:10:24.186 * Starting BGSAVE for SYNC with target: disk
  [22532] 29 Dec 03:10:24.190 * Background saving started by pid 9452
  [9452] 29 Dec 03:10:24.253 # Failed opening .rdb for saving: Permission denied
  [9452] 29 Dec 03:10:24.254 # rdbSave failed in qfork: Permission denied
  [22532] 29 Dec 03:10:24.337 # fork operation complete
  [22532] 29 Dec 03:10:24.338 # Background saving error
  [22532] 29 Dec 03:10:24.338 # Connection with slave 127.0.0.1:6380 lost.
  [22532] 29 Dec 03:10:24.338 # SYNC failed. BGSAVE child returned an error
  ```

- slave-6380
  ```text
  Connecting to MASTER 127.0.0.1:6379
  [30316] 29 Dec 03:07:43.664 * MASTER <-> SLAVE sync started
  [30316] 29 Dec 03:07:43.664 * Non blocking connect for SYNC fired the event.
  [30316] 29 Dec 03:07:43.665 # Error reply to PING from master: '-MISCONF Redis is configured to save RDB snapshots, but is currently not able to persist on disk. Commands that may modify the data set are disabled. Please check Redis logs for details about the error.'
  ```

ìœ„ ì˜¤ë¥˜ì˜ ê²½ìš° snapshotì„ rdbì— ì €ì¥í•˜ëŠ” ê³¼ì • ì¤‘ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë¡œ, ì“°ê¸° ê¶Œí•œì„ í™•ì¸í•´ ë´ì•¼ í•œë‹¤.  
redis.windows.conf íŒŒì¼ì— dir ./ë¡œ ì„¤ì • ë˜ì–´ìˆëŠ”ë°, í•´ë‹¹ ê²½ë¡œëŠ” Redis ì‹¤í–‰íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ” í•´ë‹¹ ê²½ë¡œì´ë‹¤.    
í•´ë‹¹ ë””ë ‰í† ë¦¬ì˜ ìƒìœ„ë¡œ ì´ë™í•˜ì—¬ í•´ë‹¹ ë””ë ‰í† ë¦¬ì— ì“°ê¸° ê¶Œí•œì„ ì¤€ë‹¤.  
ì†ì„± > ë³´ì•ˆ > ALL APPLICATION PACKAGES ì„ íƒ > í¸ì§‘ > ëª¨ë“ ê¶Œí•œ  
ìœ„ ì„¤ì • í›„ masterì™€ slaveë¥¼ ëª¨ë‘ ì¬ì‹¤í–‰ í•´ ì¤€ë‹¤

ì•„ë˜ëŠ” ì„±ê³µì‹œ ì¶œë ¥ë˜ëŠ” ë©”ì‹œì§€ì´ë‹¤.
- master-6379
  ```text
  [30560] 29 Dec 03:12:07.640 # Server started, Redis version 3.0.504
  [30560] 29 Dec 03:12:07.640 * DB loaded from disk: 0.000 seconds
  [30560] 29 Dec 03:12:07.640 * The server is now ready to accept connections on port 6379
  [30560] 29 Dec 03:12:13.725 * Slave 127.0.0.1:6380 asks for synchronization
  [30560] 29 Dec 03:12:13.726 * Full resync requested by slave 127.0.0.1:6380
  [30560] 29 Dec 03:12:13.726 * Starting BGSAVE for SYNC with target: disk
  [30560] 29 Dec 03:12:13.730 * Background saving started by pid 23132
  [30560] 29 Dec 03:12:13.830 # fork operation complete
  [30560] 29 Dec 03:12:13.831 * Background saving terminated with success
  [30560] 29 Dec 03:12:13.835 * Synchronization with slave 127.0.0.1:6380 succeeded
  ```
- slave-6380
  ```text
  [5376] 29 Dec 03:12:12.708 # Server started, Redis version 3.0.504
  [5376] 29 Dec 03:12:12.709 * DB loaded from disk: 0.000 seconds
  [5376] 29 Dec 03:12:12.709 * The server is now ready to accept connections on port 6380
  [5376] 29 Dec 03:12:13.723 * Connecting to MASTER 127.0.0.1:6379
  [5376] 29 Dec 03:12:13.723 * MASTER <-> SLAVE sync started
  [5376] 29 Dec 03:12:13.724 * Non blocking connect for SYNC fired the event.
  [5376] 29 Dec 03:12:13.724 * Master replied to PING, replication can continue...
  [5376] 29 Dec 03:12:13.725 * Partial resynchronization not possible (no cached master)
  [5376] 29 Dec 03:12:13.730 * Full resync from master: bcdafeb53dbc73c48d0e0e80d3e5e3965cbdc79e:1
  [5376] 29 Dec 03:12:13.835 * MASTER <-> SLAVE sync: receiving 18 bytes from master
  [5376] 29 Dec 03:12:13.836 * MASTER <-> SLAVE sync: Flushing old data
  [5376] 29 Dec 03:12:13.837 * MASTER <-> SLAVE sync: Loading DB in memory
  [5376] 29 Dec 03:12:13.838 * MASTER <-> SLAVE sync: Finished with success
  ```
</details>

### Master-Replica ì„¤ì • íŒŒì¼ ì¶”ê°€ êµ¬ì„± ë° ì‹¤í–‰
<details>
<summary>í¼ì¹˜ê¸°/ì ‘ê¸°</summary>

#### `Redis Sentinelì£¼ìš” êµ¬ì„± íŒŒì¼ êµ¬ì„±`
ğŸ“‚C:   
â”  ğŸ“‚ Program Files  
â”ƒ â”  ğŸ“‚ **Redis**  
â”ƒ â”ƒ â”  ğŸ“ log  
â”ƒ â”ƒ â”  ğŸ“‚ **conf**  
â”ƒ â”ƒ â”ƒ â”  ğŸ“„**redis.master.conf**  
â”ƒ â”ƒ â”ƒ â”  ğŸ“„**redis.slave.conf**  
â”ƒ â”ƒ â”  ğŸ“„redis.windows.conf  
â”ƒ â”ƒ â”  ğŸ“„redis.cli.exe  
â”ƒ â”ƒ â”– ğŸ“„redis.server.exe


ìœ„ì™€ ê°™ì´ conf ë””ë ‰í† ë¦¬ ìƒì„± í›„ ìƒìœ„ ë””ë ‰í† ë¦¬ì¸ Redisì˜ redis.windows.conf íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ ìƒì„±í•œ ë’¤ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•´ì¤€ë‹¤.  
(# ìœ¼ë¡œ ì£¼ì„ë˜ì–´ìˆëŠ” ë‚´ìš©ì„ ì°¾ì€ ë’¤ ê°œí–‰í•˜ì—¬ ì•„ë«ì¤„ì— ì‘ì„±í•œë‹¤.)  
ë§Œì•½ ë””ë ‰í† ë¦¬ ìƒì„±ì´ ë˜ì§€ ì•Šê±°ë‚˜, ë©”ëª¨ì¥ìœ¼ë¡œ ì—´ë¦¬ì§€ ì•ŠëŠ”ë‹¤ë©´ C: ë””ë ‰í† ë¦¬ì—ì„œ Redis ë””ë ‰í† ë¦¬ì˜ ê¶Œí•œì„ ë¶€ì—¬í•´ì•¼ í•œë‹¤.

- master-6379: redis.master.conf
  ```text
  # If port 0 is specified Redis will not listen on a TCP socket.
  port 6379
  ```
- slave-6380: redis.slave.conf
  ```text
  # If port 0 is specified Redis will not listen on a TCP socket.
  port 6380
  # bind 127.0.0.1
  bind 127.0.0.1
  # slaveof <masterip> <masterport>
  slaveof 127.0.0.1 6379
  ```
  
ìœ„ì™€ê°™ì´ ì„¤ì •í•˜ê²Œ ë˜ë©´ ì•„ë˜ ëª…ë ¹ì²˜ëŸ¼ ì„¤ì •íŒŒì¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì‹¤í–‰ì´ ê°€ëŠ¥í•´ì§„ë‹¤.
- master-6379
  ```bash
  ./redis-server.exe ./conf/redis.master.conf
  ```
- slave-6380
  ```bash
  ./redis-server.exe ./conf/redis.slave.conf
  ```

</details>



# Redis ì£¼ìš” ì„¤ì • 2 - Sentinel ì„¤ì¹˜
<details>
<summary>í¼ì¹˜ê¸°/ì ‘ê¸°</summary>

[â–¶ redis sentinel ì„¤ì • ì°¸ì¡° ë§í¬](https://adjin.tistory.com/9)  
  

## Redis Sentinelì£¼ìš” êµ¬ì„± íŒŒì¼ êµ¬ì„±
ğŸ“‚C:   
â”  ğŸ“‚ Program Files  
â”ƒ â”  ğŸ“‚ **Redis**  
â”ƒ â”ƒ â”  ğŸ“ log  
â”ƒ â”ƒ â”  ğŸ“‚ **conf**  
â”ƒ â”ƒ â”ƒ â”  ğŸ“„redis.master.conf  
â”ƒ â”ƒ â”ƒ â”  ğŸ“„redis.slave.conf  
â”ƒ â”ƒ â”ƒ â”  ğŸ“„**sentinel26379.conf**  
â”ƒ â”ƒ â”ƒ â”  ğŸ“„**sentinel26380.conf**  
â”ƒ â”ƒ â”ƒ â”– ğŸ“„**sentinel26381.conf**  
â”ƒ â”ƒ â”  ğŸ“„redis.windows.conf  
â”ƒ â”ƒ â”  ğŸ“„redis.cli.exe  
â”ƒ â”ƒ â”– ğŸ“„redis.server.exe

[â–¶ redis sentinel conf íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë§í¬](http://download.redis.io/redis-stable/sentinel.conf) ì—ì„œ sentinel.conf íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ í•œ ë’¤
conf ë””ë ‰í† ë¦¬ì—ì„œ sentinel.confíŒŒì¼ì„ 26379, 26380, 26391 ì´ë¼ëŠ” prefixë¡œ 3ê°œ êµ¬ì„±í•œ ë’¤ í•´ë‹¹ íŒŒì¼ë“¤ì˜ ì„¤ì •ë“¤ì„ ë©”ëª¨ì¥ìœ¼ë¡œ ì—´ì–´ ê°ê° ìˆ˜ì •í•œë‹¤.  
(# ìœ¼ë¡œ ì£¼ì„ë˜ì–´ìˆëŠ” ë‚´ìš©ì„ ì°¾ì€ ë’¤ ê°œí–‰í•˜ì—¬ ì•„ë«ì¤„ì— ì‘ì„±í•œë‹¤.)  
ë§Œì•½ ë””ë ‰í† ë¦¬ ìƒì„±ì´ ë˜ì§€ ì•Šê±°ë‚˜, ë©”ëª¨ì¥ìœ¼ë¡œ ì—´ë¦¬ì§€ ì•ŠëŠ”ë‹¤ë©´ C: ë””ë ‰í† ë¦¬ì—ì„œ Redis ë””ë ‰í† ë¦¬ì˜ ê¶Œí•œì„ ë¶€ì—¬í•´ì•¼ í•œë‹¤.

- sentinel{26379,26380,26381}.conf
  ```text
  # The port that this sentinel instance will run on
  port 26379 # â† í¬íŠ¸ ë³€ê²½(ê°ê° 26279, 26380, 26381 ë¡œ ì„¤ì •)
  
  # The valid charset is A-z 0-9 and the three characters ".-_".
  sentinel monitor mymaster 127.0.0.1 6379 2
  
  # Default is 30 seconds.
  sentinel down-after-milliseconds mymaster 30000
  sentinel parallel-syncs mymaster 1
  
  # Default is 3 minutes.
  sentinel failover-timeout mymaster 180000
  ```

ìœ„ì™€ê°™ì´ ì„¤ì •í•˜ê²Œ ë˜ë©´ ì•„ë˜ ëª…ë ¹ì²˜ëŸ¼ ì„¤ì •íŒŒì¼ë¡œ êµ¬ë¶„í•˜ì—¬ ê°œë³„ ì‹¤í–‰í•œë‹¤.
- master-6379
  ```bash
  ./redis-server.exe ./conf/sentinel.26379.conf --sentinel 
  ./redis-server.exe ./conf/sentinel.26380.conf --sentinel 
  ./redis-server.exe ./conf/sentinel.26381.conf --sentinel
  ```


</details>
</details>

# í…œí”Œë¦¿
<details>
<summary>í¼ì¹˜ê¸°/ì ‘ê¸°</summary>

ë‚´ìš©
</details>